(()=>{"use strict";class e{constructor(e,t="_"){this._mask=e.replace(/[d]/g,t),this._placeholder=t,this._mapBuffer=[],e.split("").forEach(((e,t)=>"d"===e?this._mapBuffer.push(t):null)),this._buffer="".padEnd(this._mapBuffer.length,t),this._value=this._mask.split("")}get mask(){return this._mask}clear(){return this._buffer="".padEnd(this._mapBuffer.length,this._placeholder),this._value=this._mask.split(""),this._mask}edit(e,t){let r=e.selectionStart;if(e.value.trim().length<this._mapBuffer.length&&(e.value=this.clear()),"insertText"===t){const t=e.value.slice(r-1,r).replace(/[^\d]/,""),s=t?this._mapBuffer.findIndex((e=>e>=r-1)):-1;if(~s){const e=this._buffer;if(e.slice(s,s+1)===this._placeholder){const r=e.split("");r[s]=t,this._buffer=r.join("")}else this._buffer=(s?e.slice(0,s):"")+t+e.slice(s,e.length-1);this._mapBuffer.forEach(((e,t)=>this._value.splice(e,1,this._buffer.slice(t,t+1)))),s+1<this._mapBuffer.length&&(r=this._mapBuffer[s+1])}else r--}else if("deleteContentForward"===t){const e=this._mapBuffer.findIndex((e=>e>=r));if(~e){const t=this._buffer;this._buffer=((e?t.slice(0,e):"")+t.slice(e+1,t.length)).padEnd(this._mapBuffer.length,this._placeholder),this._mapBuffer.forEach(((e,t)=>this._value.splice(e,1,this._buffer.slice(t,t+1)))),e<this._mapBuffer.length&&(r=this._mapBuffer[e])}}else if("deleteContentBackward"===t){const e=this._mapBuffer.filter((e=>e<=r)).length-1;if(~e){const t=this._buffer;this._buffer=((e?t.slice(0,e):"")+t.slice(e+1,t.length)).padEnd(this._mapBuffer.length,this._placeholder),this._mapBuffer.forEach(((e,t)=>this._value.splice(e,1,this._buffer.slice(t,t+1)))),e<this._mapBuffer.length&&(r=this._mapBuffer[e])}else r++}e.value=this._value.join(""),e.setSelectionRange(r,r)}}class t{constructor({url:e,errorMessageResponse:t="Ошибка сервера.",headers:r={"Content-Type":"application/json"}}){this._url=e,this._errorMessageResponse=t,this._headers=r}async request(e="GET",t="",r={}){document.preloader.start();try{const s={method:e,headers:this._headers};"POST PATCH PUT".includes(e)&&(s.body=JSON.stringify(r));const n=await fetch(this._url+t,s);if(!n.ok)throw new Error(this._errorMessageResponse);const o=await n.json();return document.preloader.stop(),o}catch(e){return document.preloader.stop(),console.error(e.message),[]}}use(e){return this.request("GET",e?`/${e}`:"")}filter(e){return this.request("GET",`?${e}`)}useSort(e){return this.request("GET",`?_sort=${e.field}&_order=${e.order}`)}add(e){return this.request("POST","",e)}delete(e){return this.request("DELETE",`/${e}`)}edit(e,t){return this.request("PUT",`/${e}`,t)}change(e,t){return this.request("PATCH",`/${e}`,t)}}(()=>{const e=document.querySelector(".popup-dialog-menu"),t=(e,t)=>{e.preventDefault();const r=window.scrollY,s=document.querySelector(t).getBoundingClientRect().top;(({draw:e,duration:t=1e3,timingplane:r="linear"})=>{const s={linear:e=>e,easeOutCubic:e=>1-Math.pow(1-e,3),easeInOutCubic:e=>e<.5?4*e*e*e:1-Math.pow(-2*e+2,3)/2,easeOutQuart:e=>1-Math.pow(1-e,5),aseOutExpo:e=>1===e?1:1-Math.pow(2,-10*e)};r in s||(r="linear");const n=Math.max(Math.round(t/16.7),1);let o=0;requestAnimationFrame((function t(){let l=0===o?0:o>n-1?1:s[r](o/n);e(l),o<n&&(o++,requestAnimationFrame(t))}))})({duration:1e3,timingplane:"easeOutCubic",draw(e){window.scrollTo(0,r+s*e)}})};document.querySelector("body").addEventListener("click",(r=>{let s,n,o=null;r.target.closest(".menu")||r.target.closest(".close-menu")||(o=r.target.closest(".popup-menu-nav__item"))||(s=r.target.closest(".link-list-menu"))||!r.target.closest(".popup-dialog-menu")&&e.classList.contains("showHide-menu")?(r.preventDefault(),e.classList.toggle("showHide-menu")):(n=r.target.closest(".button-footer"))?t(r,n.firstChild.getAttribute("href")):r.target.closest(".checkbox__descr_round-feedback")?document.openPopup.open("popup-privacy"):r.target.closest(".button_wide")?document.openPopup.open("popup-consultation"):(s=r.target.closest(".link-list-repair"))||r.target.closest(".popup .close")&&document.openPopup.close(r.target),o&&t(r,o.firstChild.getAttribute("href")),s&&document.openPopup.open("popup-repair-types")})),document.querySelector("body").addEventListener("submit",(e=>{e.preventDefault(),document.sendForm.send(e.target)}))})(),document.openPopup=new class{constructor(e,t,r){this._listLinks=[],this._classOpen=t,this._classClose=r,document.querySelectorAll("."+e).forEach((e=>this._listLinks.push(e)))}open(e){let t=!1;this._listLinks.forEach((r=>{!t&&r.classList.contains(e)?(t=!0,r.classList.remove(this._classClose),r.classList.add(this._classOpen)):t&&r.classList.add(this._classClose)}))}close(e){let t=!1;this._listLinks.forEach((r=>{e.closest("."+r.className.replace(/\s/g,"."))&&(t=!0),t&&(r.classList.remove(this._classOpen),r.classList.remove(this._classClose))}))}}("popup","active","hide"),document.preloader=new class{constructor(){const e=document.createElement("div"),t=document.createElement("div");let r=document.createElement("div");e.classList.add("preloader"),t.classList.add("preloader__row"),r.classList.add("preloader__item"),t.append(r),t.append(r.cloneNode(!1)),e.append(t),document.querySelector("body").append(e),this._preloader=e}start(){this._preloader.classList.add("working")}stop(){window.setTimeout((()=>{this._preloader.classList.remove("working")}),500)}},(()=>{const e=document.querySelector(".header-contacts__arrow"),t=document.querySelector(".header-contacts__phone-number-accord"),r=t.querySelector(".header-contacts__phone-number");e.addEventListener("click",(s=>{e.classList.toggle("open"),t.classList.toggle("open"),r.classList.toggle("open")}))})(),document.querySelectorAll('input[name="phone"]').forEach((t=>{const r=new e("+7 (ddd) ddd-dd-dd");t.addEventListener("input",(e=>{r.edit(e.target,e.inputType),e.target.classList.remove("error")})),t.addEventListener("cut",(e=>e.preventDefault())),t.addEventListener("paste",(e=>e.preventDefault()))})),(()=>{const e=document.querySelectorAll(".feedback-block__form-input_name"),t=document.querySelectorAll(".checkbox__input"),r=/[^а-яё\s\-]+/gi,s=/(^[\s\-]+|^)(.*?)(?:([\s\-]+$)|$)/i,n=/(\s{2,})|(\-{2,})/g,o=/((^|\s\-|\s|\-)[а-я])([а-я]*)/gi;e.forEach((e=>{e.addEventListener("input",(e=>{e.target.value=e.target.value.replace(r,""),e.target.classList.remove("error")})),e.addEventListener("focusout",(e=>{if(e.target.matches("input")){e.target.name;let t=e.target.value;t=t.replace(o,((e,t,r,s)=>t.toUpperCase()+s.toLowerCase())),t=t.replace(s,((e,t,r)=>`${r}`)),t=t.replace(n,((e,t,r)=>(t?" ":"")+(r?"-":""))),e.target.value=t}}))})),t.forEach((e=>{e.addEventListener("click",(e=>{e.target.parentNode.classList.remove("error")}))}))})(),document.sendForm=new class{constructor({url:e,errorMessageResponse:r="Ошибка сервера.",optionals:s={}}){this._dataForm=new t({url:e,errorMessageResponse:r,headers:{"Content-Type":"multipart/json"}}),this._optionals=s}send(e){let t=e.querySelector(".feedback-block__form-input_name");const r=e.querySelector(".checkbox__input"),s=new FormData(e),n={};s.forEach(((e,t)=>{n[t]="phone"===t?e.replace(/[^\d]+/g,""):e})),(e=>r.checked&&(!t||t.value.trim()>2)&&11===e.phone.length)(n)?(e.id in this._optionals&&this._optionals[e.id].forEach((e=>{let t;"name"in e&&"assign"in e&&("select"in e?(t=document.querySelector(e.select))&&(n[e.name]=e.assign in t?t[e.assign]:e.assign):n[e.name]=e.assign)})),this._dataForm.add(n).then((t=>{e.querySelectorAll("input").forEach((e=>{e.value=""})),e.phone.classList.remove("error"),e.querySelector(".checkbox__input").checked=!1,document.openPopup.open("popup-thank")}))):(r.checked||r.parentNode.classList.add("error"),t&&t.value.trim()<3&&t.classList.add("error"),e.phone.classList.add("error"))}}({url:"https://jsonplaceholder.typicode.com/posts",errorMessageResponse:"Технический сбой. Сообщение не отправлено",optionals:{feedback1:[{name:"form",assign:"feedback1"}],feedback2:[{name:"form",assign:"feedback2"}],feedback3:[{name:"form",assign:"feedback3"}],feedback4:[{name:"form",assign:"feedback4"}],feedback5:[{name:"form",assign:"feedback5"}],feedback6:[{name:"form",assign:"feedback6"}]}}),(()=>{const e=document.querySelector(".formula");e.addEventListener("mouseover",(e=>{if(e.target.closest(".formula-item__icon")){const t=e.target.parentElement.parentElement,r=t.querySelector(".formula-item-popup"),s=r.querySelector(".before"),n=!(t.getBoundingClientRect().top>s.offsetHeight);t.classList.add("active-item"),s.style.transform=n?"rotate(180deg)":"",r.style.transform=n?"translateY("+(t.offsetHeight+s.offsetHeight+10)+"px)":"",r.style.paddingTop=n?"40px":""}})),e.addEventListener("mouseout",(e=>{e.target.closest(".formula-item__icon")&&e.target.parentElement.parentElement.classList.remove("active-item")}))})(),(()=>{const e=[...document.querySelectorAll(".repair-types-nav__item")],t=document.querySelector(".repair-types .slider-arrow_left"),r=document.querySelector(".repair-types .slider-arrow_right"),s=document.getElementById("repair-counter"),n=s.querySelector(".slider-counter-content__current"),o=s.querySelector(".slider-counter-content__total");s.style.zIndex="2";const l=document.getElementById("nav-arrow-repair-left_base"),i=document.getElementById("nav-arrow-repair-right_base"),c=e=>{e.currentSlide=0,e.sliders.classList.add("repair-types-current"),e.slides[e.currentSlide].classList.add("slide-current"),e.style.borderWidth="1px",e.style.borderStyle="solid",e.style.borderColor="#c09133",e.style.borderRadius="25px",n.textContent=e.currentSlide+1,o.textContent=e.slides.length},a=e=>{e.style.borderWidth="",e.style.borderStyle="",e.style.borderColor="",e.style.borderRadius="",e.sliders.classList.remove("repair-types-current"),e.slides[e.currentSlide].classList.remove("slide-current")};let d;const p=e=>+e.className.replace(/[^\d]+/,"")-1;e.forEach(((e,t)=>{d||(d=e),e.slides=[],e.sliders=document.querySelector(".types-repair"+(t+1)),0===t&&(d=e),e.currentSlide=0,e.sliders.querySelectorAll(".repair-types-slider__slide").forEach((t=>{e.slides.push(t)})),e.addEventListener("click",(e=>{a(d),d=e.target,c(d)}))})),d&&c(d),t.addEventListener("click",(e=>{d.slides[d.currentSlide].classList.remove("slide-current"),d.currentSlide=Math.max(0,d.currentSlide-1),d.slides[d.currentSlide].classList.add("slide-current"),n.textContent=d.currentSlide+1})),r.addEventListener("click",(e=>{d.slides[d.currentSlide].classList.remove("slide-current"),d.currentSlide=Math.min(d.slides.length-1,d.currentSlide+1),d.slides[d.currentSlide].classList.add("slide-current"),n.textContent=d.currentSlide+1})),l.addEventListener("click",(t=>{const r=e.findIndex((e=>"none"!==e.style.display));r&&(e[r-1].style.display=""),p(d)>0&&(a(d),d=e[p(d)-1],c(d))})),i.addEventListener("click",(t=>{const r=e.findIndex((e=>"none"!==e.style.display));e.length-r>2&&(e[r].style.display="none"),(p(d)===r||p(d)<e.length-1)&&(a(d),d=e[p(d)+1],c(d))})),window.addEventListener("resize",(t=>{const r=e.findIndex((e=>"none"!==e.style.display));if(r)for(let t=0;t<r;t++)e[t].style.display="";a(d),d=e[0],c(d)}))})(),(e=>{const r=document.querySelector(".nav-list-popup-repair"),s=document.getElementById("switch-inner"),n=document.querySelector(".popup-repair-types-content-table__list tbody");r.selected=null,document.dataRepairFull=new t({url:"http://localhost:4545/items",errorMessageResponse:"Сервер регистрации недоступен. Запрос отменен."});const o=e=>{r.selected=e,e.style.background="rgba(223,205,168,0.7",s.textContent=e.textContent,document.dataRepairFull.filter(`type=${e.textContent}`).then((e=>{(e=>{let t="";e.forEach((e=>{t+=`\n      <tr class="mobile-row showHide">\n        <td class="repair-types-name">${e.name}</td>\n        <td class="mobile-col-title tablet-hide desktop-hide">Ед.измерения</td>\n        <td class="mobile-col-title tablet-hide desktop-hide">Цена за ед.</td>\n        <td class="repair-types-value">${e.units}</td>\n        <td class="repair-types-value">${e.cost} руб.</td>\n      </tr>\n      `})),n.innerHTML="",n.insertAdjacentHTML("beforeend",t)})(e)}))};document.dataRepairFull.useSort({field:"type",order:"asc"}).then((e=>{let t="Все типы услуг",s="";e.forEach((e=>{e.type!==t&&(s+=`<button class="button_o popup-repair-types-nav__item">${e.type}</button>`,t=e.type)})),r.innerHTML=s,o(r.firstChild)})),r.addEventListener("click",(e=>{e.target.closest(".nav-list-popup-repair")&&(r.selected.style.background="",o(e.target))}))})(),(()=>{const e=document.querySelector(".portfolio-slider.mobile-hide"),t=e.querySelectorAll(".portfolio-slider__slide-frame"),r=document.getElementById("portfolio-arrow_left"),s=document.getElementById("portfolio-arrow_right"),n=[],o=[];t.forEach(((e,t)=>{e.number=t,n.push(e)}));r.addEventListener("click",(e=>{const t=o.length-1;t>0&&(o[t].classList.remove("portfolio-slide-hidden"),o[t-1].classList.remove("portfolio-slide-hidden"),n.unshift(o[t]),n.unshift(o[t-1]),o.splice(t,1),o.splice(t-1,1),2===t&&(r.style.display=""),s.style.display="")})),s.addEventListener("click",(e=>{n.length>6&&(n[0].classList.add("portfolio-slide-hidden"),n[1].classList.add("portfolio-slide-hidden"),o.push(n[0]),o.push(n[1]),n.splice(0,1),n.splice(0,1),r.style.display="flex",n.length<7&&(s.style.display="none"))})),e.addEventListener("click",(e=>{document.portfolioPopupCurrentSlide=e.target.number,(()=>{if(!("portfolioPopupCurrentSlide"in document))return;const e=[...document.querySelectorAll(".popup-portfolio-slider__slide")],t=[...document.querySelectorAll(".popup-portfolio-text")],r=document.getElementById("popup_portfolio_left"),s=document.getElementById("popup_portfolio_right"),n=document.getElementById("popup-portfolio-counter"),o=n.querySelector(".slider-counter-content__current"),l=n.querySelector(".slider-counter-content__total");n.style.top="540px",n.style.zIndex="10",l.textContent=e.length;const i=()=>{e[document.portfolioPopupCurrentSlide].classList.add("slide-current"),t[document.portfolioPopupCurrentSlide].style.display="block",o.textContent=document.portfolioPopupCurrentSlide+1,0===document.portfolioPopupCurrentSlide?r.style="":(r.style.fill="blue",r.style.top="300px",r.style.zIndex="10"),document.portfolioPopupCurrentSlide===e.length-1?s.style="":(s.style.fill="blue",s.style.top="300px",s.style.zIndex="10")},c=()=>{e[document.portfolioPopupCurrentSlide].classList.remove("slide-current"),t[document.portfolioPopupCurrentSlide].style.display=""};i();const a=e=>{c(),document.portfolioPopupCurrentSlide=Math.max(0,document.portfolioPopupCurrentSlide-1),i()},d=t=>{c(),document.portfolioPopupCurrentSlide=Math.min(e.length-1,document.portfolioPopupCurrentSlide+1),i()};r.addEventListener("click",a),s.addEventListener("click",d),document.querySelector(".popup.popup-portfolio .close.mobile-hide").addEventListener("click",(()=>{r.removeEventListener("click",a),s.removeEventListener("click",d),c()}))})(),document.openPopup.open("popup-portfolio")}))})(),(()=>{const e=[...document.querySelectorAll(".reviews-slider__slide")],t=document.getElementById("reviews-arrow_left"),r=document.getElementById("reviews-arrow_right");let s=0;const n=()=>{t.style.display=0===s?"none":""},o=()=>{s===e.length-1?r.style.display="none":r.style.display=""};t.addEventListener("click",(t=>{s>0&&(e[s-1].style.display="",s--),n(),o()})),r.addEventListener("click",(t=>{s<e.length-1&&(e[s].style.display="none",s++),n(),o()}))})(),(()=>{const e=document.querySelector(".transparency-slider.row"),t=[...document.querySelectorAll(".transparency-item")],r=document.getElementById("transparency-arrow_left"),s=document.getElementById("transparency-arrow_right");let n=0;t.forEach(((e,t)=>{e.number=t}));const o=()=>{r.style.display=0===n?"none":""},l=()=>{n===t.length-1?s.style.display="none":s.style.display=""};r.addEventListener("click",(e=>{n>0&&(t[n-1].style.display="",n--),o(),l()})),s.addEventListener("click",(e=>{n<t.length-1&&(t[n].style.display="none",n++),o(),l()})),e.addEventListener("click",(e=>{const r=t.findIndex((t=>t===e.target.parentElement));~r&&(document.transpPopupCurrentSlide=r,(()=>{if(!("transpPopupCurrentSlide"in document))return;const e=[...document.querySelectorAll(".popup-transparency-slider__slide")],t=document.getElementById("transparency_left"),r=document.getElementById("transparency_right"),s=document.getElementById("transparency-popup-counter"),n=s.querySelector(".slider-counter-content__current"),o=s.querySelector(".slider-counter-content__total");s.style.top="500px",s.style.zIndex="10",o.textContent=e.length;const l=()=>{e[document.transpPopupCurrentSlide].classList.add("slide-current"),n.textContent=document.transpPopupCurrentSlide+1,0===document.transpPopupCurrentSlide?t.style.display="none":t.style.display="",document.transpPopupCurrentSlide===e.length-1?r.style.display="none":r.style.display=""},i=()=>{e[document.transpPopupCurrentSlide].classList.remove("slide-current")};l();const c=e=>{i(),document.transpPopupCurrentSlide=Math.max(0,document.transpPopupCurrentSlide-1),l()},a=t=>{i(),document.transpPopupCurrentSlide=Math.min(e.length-1,document.transpPopupCurrentSlide+1),l()};t.addEventListener("click",c),r.addEventListener("click",a),document.querySelector(".popup.popup-transparency .close.mobile-hide").addEventListener("click",(()=>{t.removeEventListener("click",c),r.removeEventListener("click",a),i()}))})(),document.openPopup.open("popup-transparency"))})),window.addEventListener("resize",(e=>{t.forEach((e=>{e.style.display=""})),n=0,o(),l()}))})(),(()=>{const e=document.querySelectorAll(".accordion li"),t=(t=-1)=>{e.forEach(((e,r)=>{const s=e.querySelector(".title_block"),n=e.querySelector(".msg");r!==t||s.classList.contains("msg-active")?(s.classList.remove("msg-active"),n.style.height="",n.classList.remove("open")):(s.classList.add("msg-active"),n.style.height=n.scrollHeight+"px",n.classList.add("open"))}))};t(),e.forEach(((e,r)=>{const s=e.querySelector(".title_block");e.querySelector(".msg"),s.addEventListener("click",(()=>{t(r)}))}))})()})();